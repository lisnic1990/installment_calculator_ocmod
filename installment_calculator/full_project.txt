--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\install.xml --- 
<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>Installment Calculator</name>
    <code>installment_calculator</code>
    <version>1.0.0.7</version>
    <author>Custom</author>
    
    <!-- ПРЯМАЯ ВСТАВКА В КОНТРОЛЛЕР ПРОДУКТА -->
    <file path="catalog/controller/product/product.php">
        <operation>
            <search><![CDATA[$data['footer'] = $this->load->controller('common/footer');]]></search>
            <add position="before"><![CDATA[
        // Installment Calculator - Direct Injection
        $this->load->model('setting/setting');
        $inst_settings = $this->model_setting_setting->getSetting('module_installment_calculator');
        
        if (!empty($inst_settings['module_installment_calculator_status'])) {
            $months_string = !empty($inst_settings['module_installment_calculator_months']) ? $inst_settings['module_installment_calculator_months'] : '4,6,10,12';
            $months = array_map('intval', array_map('trim', explode(',', $months_string)));
            sort($months);
            
            $inst_data = array();
            $inst_data['months'] = $months;
            $inst_data['default_month'] = end($months);
            $inst_data['price'] = '0';
            
            $data['installment_calculator'] = $this->load->view('extension/module/installment_calculator', $inst_data);
            $data['installment_popup'] = $this->load->view('extension/module/installment_popup');
        } else {
            $data['installment_calculator'] = '';
            $data['installment_popup'] = '';
        }
            ]]></add>
        </operation>
    </file>
    
    <!-- ВСТАВКА В ШАБЛОН unishop2_free -->
    <file path="catalog/view/theme/unishop2_free/template/product/product.twig">
        <operation>
            <search><![CDATA[<div class="product-block]]></search>
            <add position="before"><![CDATA[
{{ installment_calculator }}
            ]]></add>
        </operation>
    </file>
    
    <!-- POPUP ПЕРЕД FOOTER -->
    <file path="catalog/view/theme/unishop2_free/template/product/product.twig">
        <operation>
            <search><![CDATA[{{ footer }}]]></search>
            <add position="before"><![CDATA[
{{ installment_popup }}
            ]]></add>
        </operation>
    </file>
    
    <!-- JS В HEADER -->
    <file path="catalog/view/theme/unishop2_free/template/common/header.twig">
        <operation>
            <search><![CDATA[</head>]]></search>
            <add position="before"><![CDATA[
<script src="catalog/view/javascript/installment_calculator.js"></script>
            ]]></add>
        </operation>
    </file>
    
    <!-- Fallback для default темы -->
    <file path="catalog/view/theme/default/template/product/product.twig">
        <operation error="skip">
            <search><![CDATA[<button type="button" id="button-cart"]]></search>
            <add position="before"><![CDATA[
{{ installment_calculator }}
            ]]></add>
        </operation>
    </file>
</modification> 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\admin\controller\extension\module\installment_calculator.php --- 
<?php
class ControllerExtensionModuleInstallmentCalculator extends Controller {
    private $error = [];
    
    public function index() {
        $this->load->language('extension/module/installment_calculator');
        $this->document->setTitle($this->language->get('heading_title'));
        $this->load->model('setting/setting');
        
        if (($this->request->server['REQUEST_METHOD'] == 'POST') && $this->validate()) {
            $this->model_setting_setting->editSetting('module_installment_calculator', $this->request->post);
            $this->session->data['success'] = 'Настройки сохранены!';
            $this->response->redirect($this->url->link('marketplace/extension', 'user_token=' . $this->session->data['user_token'] . '&type=module', true));
        }
        
        if (isset($this->error['warning'])) {
            $data['error_warning'] = $this->error['warning'];
        } else {
            $data['error_warning'] = '';
        }
        
        if (isset($this->session->data['success'])) {
            $data['success'] = $this->session->data['success'];
            unset($this->session->data['success']);
        } else {
            $data['success'] = '';
        }
        
        $data['breadcrumbs'] = [];
        
        $data['breadcrumbs'][] = [
            'text' => 'Главная',
            'href' => $this->url->link('common/dashboard', 'user_token=' . $this->session->data['user_token'], true)
        ];
        
        $data['breadcrumbs'][] = [
            'text' => 'Расширения',
            'href' => $this->url->link('marketplace/extension', 'user_token=' . $this->session->data['user_token'] . '&type=module', true)
        ];
        
        $data['breadcrumbs'][] = [
            'text' => 'Калькулятор рассрочки',
            'href' => $this->url->link('extension/module/installment_calculator', 'user_token=' . $this->session->data['user_token'], true)
        ];
        
        $data['action'] = $this->url->link('extension/module/installment_calculator', 'user_token=' . $this->session->data['user_token'], true);
        $data['cancel'] = $this->url->link('marketplace/extension', 'user_token=' . $this->session->data['user_token'] . '&type=module', true);
        
        $data['heading_title'] = 'Калькулятор рассрочки';
        $data['text_edit'] = 'Редактирование модуля';
        $data['text_enabled'] = 'Включено';
        $data['text_disabled'] = 'Выключено';
        $data['text_home'] = 'Главная';
        $data['text_extension'] = 'Расширения';
        
        $data['entry_status'] = 'Статус';
        $data['entry_months'] = 'Периоды рассрочки';
        $data['entry_email'] = 'Email для заявок';
        
        $data['help_months'] = 'Укажите доступные периоды через запятую: 4,6,10,12';
        $data['help_email'] = 'Email для заявок. Если не указан - используется email магазина';
        
        $data['button_save'] = 'Сохранить';
        $data['button_cancel'] = 'Отмена';
        
        if (isset($this->request->post['module_installment_calculator_status'])) {
            $data['module_installment_calculator_status'] = $this->request->post['module_installment_calculator_status'];
        } else {
            $data['module_installment_calculator_status'] = $this->config->get('module_installment_calculator_status');
        }
        
        if (isset($this->request->post['module_installment_calculator_months'])) {
            $data['module_installment_calculator_months'] = $this->request->post['module_installment_calculator_months'];
        } elseif ($this->config->get('module_installment_calculator_months')) {
            $data['module_installment_calculator_months'] = $this->config->get('module_installment_calculator_months');
        } else {
            $data['module_installment_calculator_months'] = '4,6,10,12';
        }
        
        if (isset($this->request->post['module_installment_calculator_email'])) {
            $data['module_installment_calculator_email'] = $this->request->post['module_installment_calculator_email'];
        } elseif ($this->config->get('module_installment_calculator_email')) {
            $data['module_installment_calculator_email'] = $this->config->get('module_installment_calculator_email');
        } else {
            $data['module_installment_calculator_email'] = $this->config->get('config_email');
        }
        
        $data['home'] = $this->url->link('common/dashboard', 'user_token=' . $this->session->data['user_token'], true);
        $data['extension'] = $this->url->link('marketplace/extension', 'user_token=' . $this->session->data['user_token'] . '&type=module', true);
        $data['config_email'] = $this->config->get('config_email');
        
        $data['header'] = $this->load->controller('common/header');
        $data['column_left'] = $this->load->controller('common/column_left');
        $data['footer'] = $this->load->controller('common/footer');
        
        $this->response->setOutput($this->load->view('extension/module/installment_calculator', $data));
    }
    
    protected function validate() {
        if (!$this->user->hasPermission('modify', 'extension/module/installment_calculator')) {
            $this->error['warning'] = 'У вас нет прав!';
        }
        return !$this->error;
    }
    
    public function install() {
        $this->load->model('setting/event');
        
        // Удаляем старые события если есть
        $this->model_setting_event->deleteEventByCode('installment_calculator');
        
        // Добавляем событие для инъекции в контроллер продукта
        $this->model_setting_event->addEvent(
            'installment_calculator',
            'catalog/controller/product/product/before',
            'extension/module/installment_calculator/injectToProduct'
        );
        
        // Даем права администратору
        $this->load->model('user/user_group');
        $this->model_user_user_group->addPermission(1, 'access', 'extension/module/installment_calculator');
        $this->model_user_user_group->addPermission(1, 'modify', 'extension/module/installment_calculator');
        
        // Устанавливаем дефолтные настройки
        $this->load->model('setting/setting');
        $defaults = [
            'module_installment_calculator_status' => 1,
            'module_installment_calculator_months' => '4,6,10,12',
            'module_installment_calculator_email' => $this->config->get('config_email')
        ];
        $this->model_setting_setting->editSetting('module_installment_calculator', $defaults);
    }
    
    public function uninstall() {
        $this->load->model('setting/event');
        $this->model_setting_event->deleteEventByCode('installment_calculator');
    }
} 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\admin\language\ru-ru\extension\module\installment_calculator.php --- 
<?php
// Heading
$_['heading_title'] = 'Калькулятор рассрочки';

// Text
$_['text_extension'] = 'Расширения';
$_['text_edit'] = 'Редактирование модуля';
$_['text_success'] = 'Настройки модуля успешно обновлены!';
$_['text_enabled'] = 'Включено';
$_['text_disabled'] = 'Выключено';
$_['text_home'] = 'Главная';

// Entry
$_['entry_status'] = 'Статус';
$_['entry_months'] = 'Периоды рассрочки';
$_['entry_email'] = 'Email для заявок';

// Help
$_['help_months'] = 'Укажите доступные периоды рассрочки через запятую, например: 4,6,10,12';
$_['help_email'] = 'Email для получения заявок на рассрочку. Если не указан, используется основной email магазина';

// Button
$_['button_save'] = 'Сохранить';
$_['button_cancel'] = 'Отмена';

// Error
$_['error_permission'] = 'У вас нет прав для управления этим модулем!'; 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\admin\view\template\extension\module\installment_calculator.twig --- 
{{ header }}{{ column_left }}
<div id="content">
    <div class="page-header">
        <div class="container-fluid">
            <div class="pull-right">
                <button type="submit" form="form-installment" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
                <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a>
            </div>
            <h1>{{ heading_title }}</h1>
            <ul class="breadcrumb">
                <li><a href="{{ home }}">{{ text_home }}</a></li>
                <li><a href="{{ extension }}">{{ text_extension }}</a></li>
                <li><a href="{{ cancel }}">{{ heading_title }}</a></li>
            </ul>
        </div>
    </div>
    <div class="container-fluid">
        {% if error_warning %}
        <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
            <button type="button" class="close" data-dismiss="alert">&times;</button>
        </div>
        {% endif %}
        {% if success %}
        <div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> {{ success }}
            <button type="button" class="close" data-dismiss="alert">&times;</button>
        </div>
        {% endif %}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }}</h3>
            </div>
            <div class="panel-body">
                <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-installment" class="form-horizontal">
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>
                        <div class="col-sm-10">
                            <select name="module_installment_calculator_status" id="input-status" class="form-control">
                                {% if module_installment_calculator_status %}
                                <option value="1" selected="selected">{{ text_enabled }}</option>
                                <option value="0">{{ text_disabled }}</option>
                                {% else %}
                                <option value="1">{{ text_enabled }}</option>
                                <option value="0" selected="selected">{{ text_disabled }}</option>
                                {% endif %}
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-months"><span data-toggle="tooltip" title="{{ help_months }}">{{ entry_months }}</span></label>
                        <div class="col-sm-10">
                            <input type="text" name="module_installment_calculator_months" value="{{ module_installment_calculator_months }}" placeholder="4,6,10,12" id="input-months" class="form-control" />
                            <span class="help-block">{{ help_months }}</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-email">{{ entry_email }}</label>
                        <div class="col-sm-10">
                            <input type="email" name="module_installment_calculator_email" value="{{ module_installment_calculator_email }}" placeholder="{{ config_email }}" id="input-email" class="form-control" />
                            <span class="help-block">{{ help_email }}</span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{{ footer }} 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\catalog\controller\extension\module\installment_calculator.php --- 
<?php
class ControllerExtensionModuleInstallmentCalculator extends Controller {
    
    // Метод для инъекции через событие
    public function injectToProduct(&$route, &$data, &$output) {
        $this->load->model('setting/setting');
        $settings = $this->model_setting_setting->getSetting('module_installment_calculator');
        
        // Проверяем статус модуля
        if (empty($settings['module_installment_calculator_status'])) {
            return;
        }
        
        // Генерируем HTML
        $calculator_html = $this->index();
        $popup_html = $this->popup();
        
        // Вставляем в output напрямую
        if (!empty($calculator_html) && !empty($popup_html)) {
            // Находим место для вставки калькулятора (перед кнопкой купить)
            $search = '<button type="button" id="button-cart"';
            if (strpos($output, $search) !== false) {
                $output = str_replace(
                    $search,
                    $calculator_html . "\n" . $search,
                    $output
                );
            }
            
            // Вставляем popup перед </body>
            $output = str_replace(
                '</body>',
                $popup_html . "\n</body>",
                $output
            );
        }
    }
    
    public function index() {
        $this->load->language('extension/module/installment_calculator');
        $this->load->model('setting/setting');
        
        $settings = $this->model_setting_setting->getSetting('module_installment_calculator');
        
        if (empty($settings['module_installment_calculator_status'])) {
            return '';
        }
        
        $months_string = !empty($settings['module_installment_calculator_months']) 
            ? $settings['module_installment_calculator_months'] 
            : '4,6,10,12';
        
        $months = array_map('intval', array_map('trim', explode(',', $months_string)));
        sort($months);
        
        $data['months'] = $months;
        $data['default_month'] = end($months);
        $data['price'] = '0';
        
        return $this->load->view('extension/module/installment_calculator', $data);
    }
    
    public function popup() {
        $this->load->language('extension/module/installment_calculator');
        return $this->load->view('extension/module/installment_popup');
    }
    
    public function send() {
        $this->load->language('extension/module/installment_calculator');
        $json = [];
        
        if (empty($this->request->post['name'])) {
            $json['error'] = $this->language->get('error_name');
        }
        
        if (empty($this->request->post['phone'])) {
            $json['error'] = $this->language->get('error_phone');
        }
        
        if (empty($this->request->post['product_name'])) {
            $json['error'] = 'Не указан товар';
        }
        
        if (empty($this->request->post['months']) || !is_numeric($this->request->post['months'])) {
            $json['error'] = 'Не указан период рассрочки';
        }
        
        if (!isset($json['error'])) {
            $this->load->model('setting/setting');
            $settings = $this->model_setting_setting->getSetting('module_installment_calculator');
            
            $mail_to = !empty($settings['module_installment_calculator_email']) 
                ? $settings['module_installment_calculator_email'] 
                : $this->config->get('config_email');
            
            try {
                $mail = new Mail($this->config->get('config_mail_engine'));
                $mail->parameter = $this->config->get('config_mail_parameter');
                $mail->smtp_hostname = $this->config->get('config_mail_smtp_hostname');
                $mail->smtp_username = $this->config->get('config_mail_smtp_username');
                $mail->smtp_password = html_entity_decode($this->config->get('config_mail_smtp_password'), ENT_QUOTES, 'UTF-8');
                $mail->smtp_port = $this->config->get('config_mail_smtp_port');
                $mail->smtp_timeout = $this->config->get('config_mail_smtp_timeout');
                
                $mail->setTo($mail_to);
                $mail->setFrom($this->config->get('config_email'));
                $mail->setSender($this->config->get('config_name'));
                $mail->setSubject('Новая заявка на рассрочку - ' . $this->request->post['product_name']);
                
                $message = "=== ЗАЯВКА НА РАССРОЧКУ ===\n\n";
                $message .= "Клиент:\n";
                $message .= "  Имя: " . $this->request->post['name'] . "\n";
                $message .= "  Телефон: " . $this->request->post['phone'] . "\n\n";
                $message .= "Товар:\n";
                $message .= "  Название: " . $this->request->post['product_name'] . "\n";
                $message .= "  Цена: " . $this->request->post['price'] . "\n";
                $message .= "  Ссылка: " . $this->request->post['product_url'] . "\n\n";
                $message .= "Условия рассрочки:\n";
                $message .= "  Период: " . $this->request->post['months'] . " месяцев\n";
                $message .= "  Ежемесячный платёж: " . $this->request->post['monthly'] . "\n\n";
                $message .= "Дата заявки: " . date('d.m.Y H:i:s') . "\n";
                $message .= "IP адрес: " . $this->request->server['REMOTE_ADDR'] . "\n";
                
                $mail->setText($message);
                $mail->send();
                
                $json['success'] = $this->language->get('text_success');
                
            } catch (Exception $e) {
                $json['error'] = 'Ошибка отправки письма. Попробуйте позже.';
                $this->log->write('Installment Calculator Mail Error: ' . $e->getMessage());
            }
        }
        
        $this->response->addHeader('Content-Type: application/json');
        $this->response->setOutput(json_encode($json));
    }
} 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\catalog\language\ru-ru\extension\module\installment_calculator.php --- 
<?php
$_['text_success'] = 'Заявка отправлена! Мы свяжемся с вами.';
$_['error_name'] = 'Укажите имя';
$_['error_phone'] = 'Укажите телефон'; 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\catalog\view\javascript\installment_calculator.js --- 
$(document).ready(function() {
    const $calculator = $('.installment-calculator');
    
    if (!$calculator.length) {
        console.log('Installment Calculator: блок не найден');
        return;
    }
    
    // Получение цены - UniShop2 специфично
    let price = 0;
    
    // Попытка 1: стандартный селектор
    let priceText = $('.price .price-new').first().text();
    
    // Попытка 2: для UniShop2
    if (!priceText) {
        priceText = $('ul.list-unstyled li h2').first().text();
    }
    
    // Попытка 3: любая цена на странице
    if (!priceText) {
        priceText = $('h2:contains("р.")').first().text();
    }
    
    console.log('Price text found:', priceText);
    
    price = parseFloat(priceText.replace(/[^\d]/g, ''));
    
    if (!price || price <= 0) {
        console.error('Installment Calculator: Не удалось получить цену товара');
        // Пробуем взять из meta или data атрибута
        price = parseFloat($('meta[property="product:price:amount"]').attr('content')) || 0;
    }
    
    console.log('Final price:', price);
    
    if (price <= 0) {
        return;
    }
    
    // Получение доступных месяцев
    let availableMonths = [12];
    try {
        const monthsData = $calculator.attr('data-months');
        if (monthsData) {
            availableMonths = JSON.parse(monthsData);
        }
    } catch (e) {
        console.error('Installment Calculator: Ошибка парсинга месяцев', e);
    }
    
    // Данные товара - для UniShop2
    const productName = $('h1').first().text().trim() || $('title').text().trim();
    const productImage = $('.thumbnail img').first().attr('src') || 
                         $('.product-thumb img').first().attr('src') ||
                         $('img[itemprop="image"]').first().attr('src');
    const productUrl = window.location.href;
    
    console.log('Product:', productName, productImage);
    
    let currentMonths = availableMonths[availableMonths.length - 1] || 12;
    
    // Функция расчёта
    function calculate(months) {
        const monthly = Math.round(price / months);
        $('.installment-monthly').text(monthly);
        $('.installment-period').text(months);
        $('.installment-total').text(price);
        $('.installment-price').text(price);
        currentMonths = months;
        
        $('.installment-period-btn').each(function() {
            const btnMonths = parseInt($(this).attr('data-months'));
            if (btnMonths === months) {
                $(this).addClass('active').css({
                    'background': '#5c6bc0',
                    'color': 'white',
                    'border-color': '#5c6bc0'
                });
            } else {
                $(this).removeClass('active').css({
                    'background': 'white',
                    'color': '#333',
                    'border-color': '#e5e5e5'
                });
            }
        });
    }
    
    // Инициализация
    calculate(currentMonths);
    
    // Обработчик выбора периода
    $('.installment-period-btn').on('click', function() {
        const selectedMonths = parseInt($(this).attr('data-months'));
        calculate(selectedMonths);
    });
    
    // Открытие модального окна
    $('.installment-btn').on('click', function() {
        $('#popup-product-name').text(productName);
        $('#popup-product-image').attr('src', productImage);
        $('#popup-price').text(price);
        $('#popup-total').text(price);
        $('#popup-months').text(currentMonths);
        $('#popup-monthly').text(Math.round(price / currentMonths));
        
        $('#installment-popup').modal('show');
    });
    
    // Отправка формы
    $('#installment-form').on('submit', function(e) {
        e.preventDefault();
        
        const formData = {
            name: $('input[name="name"]').val().trim(),
            phone: $('input[name="phone"]').val().trim(),
            product_name: productName,
            price: price + ' р.',
            months: currentMonths,
            monthly: Math.round(price / currentMonths) + ' р.',
            product_url: productUrl
        };
        
        if (!formData.name) {
            $('#installment-message')
                .removeClass('alert-success')
                .addClass('alert alert-danger')
                .text('Пожалуйста, укажите ваше имя')
                .show();
            return;
        }
        
        if (!formData.phone) {
            $('#installment-message')
                .removeClass('alert-success')
                .addClass('alert alert-danger')
                .text('Пожалуйста, укажите номер телефона')
                .show();
            return;
        }
        
        $.ajax({
            url: 'index.php?route=extension/module/installment_calculator/send',
            type: 'POST',
            data: formData,
            dataType: 'json',
            beforeSend: function() {
                $('#installment-form button[type="submit"]')
                    .prop('disabled', true)
                    .html('<i class="fa fa-spinner fa-spin"></i> Отправка...');
                $('#installment-message').hide();
            },
            complete: function() {
                $('#installment-form button[type="submit"]')
                    .prop('disabled', false)
                    .text('Отправить данные');
            },
            success: function(json) {
                if (json.error) {
                    $('#installment-message')
                        .removeClass('alert-success')
                        .addClass('alert alert-danger')
                        .text(json.error)
                        .show();
                } else if (json.success) {
                    $('#installment-message')
                        .removeClass('alert-danger')
                        .addClass('alert alert-success')
                        .text(json.success)
                        .show();
                    
                    $('#installment-form')[0].reset();
                    
                    setTimeout(function() {
                        $('#installment-popup').modal('hide');
                        $('#installment-message').hide();
                    }, 2000);
                }
            },
            error: function(xhr, status, error) {
                console.error('AJAX Error:', status, error);
                $('#installment-message')
                    .removeClass('alert-success')
                    .addClass('alert alert-danger')
                    .text('Ошибка отправки. Пожалуйста, попробуйте позже.')
                    .show();
            }
        });
    });
    
    $('#installment-form input').on('focus', function() {
        $('#installment-message').fadeOut();
    });
}); 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\catalog\view\theme\default\template\extension\module\installment_calculator.twig --- 
<div class="installment-calculator" style="border: 1px solid #e5e5e5; border-radius: 8px; padding: 20px; margin: 20px 0;" data-months='{{ months|json_encode|raw }}'>
    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
        <svg width="40" height="40" viewBox="0 0 40 40" style="color: #e91e63;">
            <path fill="currentColor" d="M20 8c-6.6 0-12 5.4-12 12s5.4 12 12 12 12-5.4 12-12-5.4-12-12-12zm0 2c5.5 0 10 4.5 10 10s-4.5 10-10 10-10-4.5-10-10 4.5-10 10-10z"/>
        </svg>
        <div>
            <div style="font-size: 32px; font-weight: 700;">
                <span class="installment-price">{{ price|replace({' лей': '', ' ': ''}) }}</span> лей
            </div>
            <div style="background: #e91e63; color: white; display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 14px; margin-top: 5px;">
                Рассрочка <span class="installment-period">{{ default_month }}</span>м.
            </div>
        </div>
    </div>
    
    <!-- Селектор периодов -->
    <div class="installment-period-selector" style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
        {% for month in months %}
        <button type="button" class="installment-period-btn" data-months="{{ month }}" style="
            padding: 10px 20px;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            {% if month == default_month %}
            background: #5c6bc0;
            color: white;
            border-color: #5c6bc0;
            {% endif %}
        " onmouseover="if(!this.classList.contains('active')) { this.style.borderColor='#5c6bc0'; this.style.color='#5c6bc0'; }" onmouseout="if(!this.classList.contains('active')) { this.style.borderColor='#e5e5e5'; this.style.color='#333'; }">
            {{ month }} мес.
        </button>
        {% endfor %}
    </div>
    
    <div style="font-size: 18px; color: #e91e63; margin-bottom: 20px;">
        <span class="installment-total">{{ price|replace({' лей': '', ' ': ''}) }}</span> лей : 
        <span class="installment-period">{{ default_month }}</span> месяцев = 
        <span class="installment-monthly">0</span> лей / месяц
    </div>
    
    <button class="btn btn-primary installment-btn" style="width: 100%; background: #5c6bc0; border: none; padding: 15px; font-size: 16px; border-radius: 5px; cursor: pointer; color: white;">
        <svg width="20" height="20" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 8px;" fill="currentColor">
            <path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
        </svg>
        В рассрочку
    </button>
    
    <div style="margin-top: 20px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#5c6bc0"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            <span>Без переплат</span>
        </div>
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#5c6bc0"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
            <span>Без первого взноса</span>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#5c6bc0"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
            <span>Мгновенное оформление</span>
        </div>
    </div>
</div> 
------------------------------ 
--- FILE: D:\Work\MyOCMODs\Installment Calculator\installment_calculator\upload\catalog\view\theme\default\template\extension\module\installment_popup.twig --- 
<div id="installment-popup" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document" style="max-width: 600px;">
        <div class="modal-content" style="border-radius: 12px;">
            <div class="modal-header" style="border-bottom: none; padding: 20px 30px;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="#5c6bc0">
                        <path d="M20 8c-6.6 0-12 5.4-12 12s5.4 12 12 12 12-5.4 12-12-5.4-12-12-12z"/>
                    </svg>
                    <h4 style="margin: 0; font-size: 24px; font-weight: 700;">Оформить рассрочку</h4>
                </div>
                <button type="button" class="close" data-dismiss="modal" style="font-size: 30px; opacity: 0.5;">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px 30px;">
                <div style="display: flex; gap: 20px; background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <img id="popup-product-image" src="" style="width: 80px; height: 80px; object-fit: contain;">
                    <div style="flex: 1;">
                        <div id="popup-product-name" style="font-weight: 600; margin-bottom: 10px;"></div>
                        <div style="font-size: 20px; font-weight: 700; color: #5c6bc0;">
                            <span id="popup-price"></span> лей
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 30px;">
                    <div style="background: #e8eaf6; padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Сумма рассрочки:</div>
                        <div style="font-size: 20px; font-weight: 700; color: #5c6bc0;">
                            <span id="popup-total"></span> лей
                        </div>
                    </div>
                    <div style="background: #e8eaf6; padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Период рассрочки:</div>
                        <div style="font-size: 20px; font-weight: 700; color: #5c6bc0;">
                            <span id="popup-months"></span> месяцев
                        </div>
                    </div>
                    <div style="background: #e8eaf6; padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Оплата в месяц:</div>
                        <div style="font-size: 20px; font-weight: 700; color: #5c6bc0;">
                            <span id="popup-monthly"></span> лей
                        </div>
                    </div>
                </div>
                
                <h5 style="font-size: 18px; font-weight: 700; margin-bottom: 15px;">Оставьте данные</h5>
                <p style="color: #666; margin-bottom: 20px;">С вами свяжется наш менеджер</p>
                
                <form id="installment-form">
                    <div class="form-group">
                        <label style="font-size: 14px; color: #5c6bc0;">Имя</label>
                        <input type="text" name="name" class="form-control" style="border-radius: 8px; border: 1px solid #ddd; padding: 12px;" required>
                    </div>
                    <div class="form-group" style="position: relative;">
                        <label style="font-size: 14px; color: #5c6bc0;">Номер телефона</label>
                        <input type="tel" name="phone" class="form-control" style="border-radius: 8px; border: 1px solid #ddd; padding: 12px;" required>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#e91e63" style="position: absolute; right: 12px; bottom: 12px;">
                            <path d="M20 15.5c-1.25 0-2.45-.2-3.57-.57-.35-.11-.74-.03-1.02.24l-2.2 2.2c-2.83-1.44-5.15-3.75-6.59-6.59l2.2-2.21c.28-.26.36-.65.25-1C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.5c0-.55-.45-1-1-1z"/>
                        </svg>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; background: #5c6bc0; border: none; padding: 15px; font-size: 16px; border-radius: 8px; margin-top: 10px;">
                        Отправить данные
                    </button>
                </form>
                <div id="installment-message" style="margin-top: 15px; display: none;"></div>
            </div>
        </div>
    </div>
</div> 
------------------------------ 
