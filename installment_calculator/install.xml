<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>Installment Calculator</name>
    <code>installment_calculator</code>
    <version>1.0.0.5</version>
    <author>Custom</author>
    
    <!-- Вариант 1: После div#product -->
    <file path="catalog/view/theme/*/template/product/product.twig">
        <operation>
            <search><![CDATA[<div id="product">]]></search>
            <add position="after"><![CDATA[
{% if installment_calculator %}
{{ installment_calculator }}
{% endif %}
            ]]></add>
        </operation>
    </file>
    
    <!-- Вариант 2: Перед кнопкой купить (если первый не сработает) -->
    <file path="catalog/view/theme/*/template/product/product.twig">
        <operation error="skip">
            <search><![CDATA[<button type="button" id="button-cart"]]></search>
            <add position="before"><![CDATA[
{% if installment_calculator %}
{{ installment_calculator }}
{% endif %}
            ]]></add>
        </operation>
    </file>
    
    <!-- Вариант 3: После цены (для некоторых тем) -->
    <file path="catalog/view/theme/*/template/product/product.twig">
        <operation error="skip">
            <search><![CDATA[<ul class="list-unstyled">]]></search>
            <add position="after"><![CDATA[
{% if installment_calculator %}
{{ installment_calculator }}
{% endif %}
            ]]></add>
        </operation>
    </file>
    
    <!-- Popup всегда в конце -->
    <file path="catalog/view/theme/*/template/product/product.twig">
        <operation>
            <search><![CDATA[{{ footer }}]]></search>
            <add position="before"><![CDATA[
{% if installment_popup %}
{{ installment_popup }}
{% endif %}
            ]]></add>
        </operation>
    </file>
    
    <!-- Подключение JS -->
    <file path="catalog/view/theme/*/template/common/header.twig">
        <operation>
            <search><![CDATA[</head>]]></search>
            <add position="before"><![CDATA[
<script src="catalog/view/javascript/installment_calculator.js"></script>
            ]]></add>
        </operation>
    </file>
</modification>